
Config: 
  Flags:
    report_schedule:  "5 * * * * *"
    remote_auth:
      - "UserA:ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAICtFRLdSvayFQwQdIOk6NKuEpEK7KvYBQz8LUVerSo8T"
      - "UserB:ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIJyubt40tutUSi3FQqcEzbDUu14RdLstEbURvX/M2bM/"
      - "Test:ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIDyE3uP86ZKN+rDOOrv9MJSZfKDKjDLL6KY+JrT6iwlk"

Policies:

  - id: "RUNTIM-001-NGINX"
    type: "runtime"
    enforcement:
      - environment: "all"
        fatal: "false"
        exceptions: "development"
        confidence: "high"
    metadata:
      name: "RUNTIME System Compliance"
      description: "Enforce system compliance at runtime"
      msg_solution: ""
      msg_error: ""
      tags:
        - "config"
        - "runtime"
        - "enforce"
      score: "8"
    _runtime:
      config: runtime/nginx.yaml
      observe: targets/scan/nginx.conf

  - id: "RUNTIM-002"
    type: "runtime"
    enforcement:
      - environment: "all"
        fatal: "false"
        exceptions: "development"
        confidence: "high"
    metadata:
      name: "RUNTIME System Compliance"
      description: "Enforce system compliance at runtime"
      msg_solution: ""
      msg_error: ""
      tags:
        - "config"
        - "runtime"
        - "enforce"
      score: "8"
    _runtime:
      config: runtime/simple_https.yaml

  - id: "NOT-FOR-REMOTE-003"
    type: "WRONG TYPE"
    enforcement:
      - environment: "all"
        fatal: "false"
        exceptions: "development"
        confidence: "high"
    metadata:
      name: "RUNTIME System Compliance"
      description: "Enforce system compliance at runtime"
      msg_solution: ""
      msg_error: ""
      tags:
        - "config"
        - "runtime"
        - "enforce"
      score: "8"
    _runtime:
      config: runtime/simple_https.yaml


  - id: "REMOTE-API-001"
    type: "api"
    enforcement:
      - environment: "production"
        fatal: "true"
        exceptions: "false"
        confidence: "high"
      - environment: "development"
        fatal: "true"
        exceptions: "false"
        confidence: "high"
    metadata:
      name: "API Regex Compliance"
      description: "Enforce schema compliance on API configuration files"
      msg_solution: "Generic solution message to development issue."
      msg_error: "Generic error message for development issue"
      tags:
        - "config"
        - "ini"
        - "schema"
      confidence: "high"
      score: "8"
    _api:
      endpoint: "https://httpbin.org/user-agent"
      insecure: false
      request: "GET"
      response_type: "application/json"
      auth: 
        type: bearer
        token_env: TOKEN 
    _regex:
      - \s*user-agent\s*