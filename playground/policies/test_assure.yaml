Policies:
  - id: "ASSURE-001 Required Security Settings"
    type: "assure"
    filepattern: "config.*\\.(json|yaml|ini)$"
    enforcement:
      - environment: "production"
        fatal: "true"
        exceptions: "false"
        confidence: "high"
      - environment: "development"
        fatal: "false"
        exceptions: "false"
        confidence: "high"
    metadata:
      name: "Ensure required security settings"
      description: "Verify that configuration files contain required security settings"
      msg_solution: "Add the missing security settings to the configuration file."
      msg_error: "Configuration file is missing required security settings."
      tags:
        - "security"
        - "config"
      score: "8"
    _regex:
      - "ssl_enabled:\\s*true"
      - "use_encryption:\\s*true"
      - "min_password_length:\\s*12"
      - "enable_2fa:\\s*true"

  - id: "ASSURE-002 Logging Configuration"
    type: "assure"
    filepattern: "log.*\\.(json|yaml|ini)$"
    enforcement:
      - environment: "all"
        fatal: "true"
        exceptions: "false"
        confidence: "high"
    metadata:
      name: "Ensure proper logging configuration"
      description: "Verify that logging configuration files contain required settings"
      msg_solution: "Add the missing logging settings to the configuration file."
      msg_error: "Logging configuration file is missing required settings."
      tags:
        - "logging"
        - "config"
      score: "7"
    _regex:
      - "log_level:\\s*(info|debug|warn|error)"
      - "log_format:\\s*json"
      - "log_retention_days:\\s*\\d+"
      - "enable_audit_logs:\\s*true"

  - id: "ASSURE-003 Required Environment Variables"
    type: "assure"
    filepattern: ".*\\.env"
    enforcement:
      - environment: "all"
        fatal: "true"
        exceptions: "false"
        confidence: "high"
    metadata:
      name: "Ensure required environment variables"
      description: "Verify that .env files contain all required environment variables"
      msg_solution: "Add the missing environment variables to the .env file."
      msg_error: ".env file is missing required environment variables."
      tags:
        - "env"
        - "config"
      score: "7"
    _regex:
      - "^DATABASE_URL="
      - "^API_KEY="
      - "^NODE_ENV="
      - "^PORT="