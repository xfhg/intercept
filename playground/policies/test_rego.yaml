
Version: "1.0.0"

Policies:

  - id: "REGO-001"
    type: "rego"
    filepattern: 'input_\w+\.json$'
    enforcement:
      - environment: "all"
        fatal: "false"
        exceptions: "development"
        confidence: "high"
    metadata:
      name: "REGO Schema Compliance"
      description: "Enforce schema compliance on JSON configuration file"
      tags:
        - "config"
        - "ini"
        - "schema"
      score: "8"
    _rego:
      policy_file: policies/rego/simple.rego
      policy_data: policies/rego/simple_policy_data.json
      policy_query: data.rbac.allow

  - id: "REGO-002"
    type: "rego"
    filepattern: 'nginx\.conf$'
    enforcement:
      - environment: "all"
        fatal: "false"
        exceptions: "development"
        confidence: "high"
    metadata:
      name: "Nginx Configuration Security Compliance"
      description: "Enforce security best practices for Nginx configuration"
      tags:
        - "nginx"
        - "security"
        - "configuration"
      score: "9"
    _rego:
      policy_file: policies/rego/nginx_security.rego
      policy_data: policies/rego/nginx_security_data.json
      policy_query: data.nginx.allow