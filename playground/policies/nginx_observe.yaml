

Config: 
  Flags:
    policy_schedule: "*/30 * * * * *"
    report_schedule: "*/30 * * * * *"
    target: "targets/"
 

Policies:
  - id: "SCAN-001 Server Tokens"
    schedule: "*/30 * * * * *"
    type: "scan"
    filepattern: "nginx.conf"
    enforcement:
      - environment: "all"
        fatal: "true"
        exceptions: "false"
        confidence: "high"
    metadata:
      name: "Detect server_tokens on"
      description: "Ensure that server_tokens is not enabled to avoid revealing version info."
      msg_solution: "Set server_tokens to off in the nginx configuration."
      msg_error: "server_tokens is enabled, exposing Nginx version."
      tags:
        - "security"
        - "nginx"
      score: "7"
    _regex:
      - "server_tokens\\s+on;"

  - id: "SCAN-007 Access Logs Disabled"
    type: "scan"
    filepattern: "nginx.conf"
    enforcement:
      - environment: "all"
        fatal: "true"
        exceptions: "false"
        confidence: "medium"
    metadata:
      name: "Detect access_log off"
      description: "Ensure access logs are enabled."
      msg_solution: "Remove 'access_log off' to enable logging."
      msg_error: "Access logs are disabled, which may hide important access data."
      tags:
        - "security"
        - "logging"
      score: "6"
    _regex:
      - "access_log\\s+off;"

  - id: "SCAN-008 Autoindex Enabled"
    type: "scan"
    filepattern: "nginx.conf"
    enforcement:
      - environment: "all"
        fatal: "true"
        exceptions: "false"
        confidence: "high"
    metadata:
      name: "Detect autoindex on"
      description: "Ensure directory indexing is not enabled."
      msg_solution: "Disable 'autoindex on' to prevent directory listing."
      msg_error: "Directory indexing is enabled, which may expose sensitive files."
      tags:
        - "security"
        - "files"
      score: "8"
    _regex:
      - "autoindex\\s+on;"
