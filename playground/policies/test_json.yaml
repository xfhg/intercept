Version: "1.0.0"

Policies:
  - id: "JSON-001"
    type: "json"
    filepattern: "example\\.json$"
    enforcement:
      - environment: "all"
        fatal: "true"
        exceptions: "false"
        confidence: "high"
    metadata:
      name: "Strict Application Configuration Schema"
      description: "Enforce strict schema compliance on application configuration JSON files"
      msg_solution: "Update the configuration file to exactly match the required schema, removing any extra fields and correcting data types."
      msg_error: "Application configuration JSON file does not comply with the strict required schema."
      tags:
        - "config"
        - "json"
        - "strict"
      score: "9"
    _schema:
      strict: true
      patch: false
      structure: |
        {
          app: {
            name: string
            version: string & =~"^\\d+\\.\\d+\\.\\d+$"
            port: int
          }
          database: {
            host: string
            port: int
            name: string
            user: string
          }
          logging: {
            level: "debug" | "info" | "warn" | "error"
            format: "json" | "text"
          }
          features: {
            featureA: bool
            featureB: bool
            flags: {
              blocker: bool
            }
          }
        }

  - id: "JSON-002"
    type: "json"
    filepattern: "example\\.json$"
    enforcement:
      - environment: "all"
        fatal: "false"
        exceptions: "false"
        confidence: "high"
    metadata:
      name: "Flexible Application Configuration Schema"
      description: "Enforce flexible schema compliance on application configuration JSON files"
      msg_solution: "Consider adjusting the configuration file to better match the recommended structure, but additional fields are allowed."
      msg_error: "Application configuration JSON file has some deviations from the recommended schema."
      tags:
        - "config"
        - "json"
        - "flexible"
      score: "7"
    _schema:
      strict: false
      patch: false
      structure: |
        {
          app: {
            name: string
            version: string
            port: string | int
          }
          database: {
            host: string
            port: int
            name: string
            user: string
          }
          logging: {
            level: string
            format: string
          }
          features: {
            featureA: bool
            featureB: bool
            [string]: bool | {...}
          }
        }