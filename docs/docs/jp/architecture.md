# アーキテクチャ

Interceptは、業界標準のポリシーベースのアプローチを提供し、セキュリティとコンプライアンスを実現します。さまざまな種類のファイル、システム、サービス、ハードニング、セットアップ、エンドポイントをスキャン、分析、パッチ適用する包括的な機能を備えています。Interceptは、アドホック、リアルタイム、イベントトリガーのモードで動作できます。

---

![Interceptのアーキテクチャ](/arch.png)

---

コードベースやシステム状態を徹底的にスキャンするために、INTERCEPTポリシーエンジンは、コンプライアンスとセキュリティ要件のほとんど、あるいはすべてに適合する多様でコンテキスト化されたポリシータイプを定義することを可能にします。

# 🔋 バッテリー同梱

## ポリシータイプ

### SCANポリシー

スキャンポリシーは、正規表現パターンのために非バイナリファイルを徹底的に検査します。これらのポリシーは、漏洩またはハードコーディングされたAPIキー、SSL証明書、パスワード、認証トークンなどの潜在的なセキュリティリスクを特定するために重要です。スキャンポリシーの準拠状態は、定義されたパターンが指定されたターゲットパス内に見つからない場合に達成されます。

### ASSUREポリシー

スキャンポリシーとは逆に、アシュアランスポリシーは定義されたパターンの存在を強制します。これらは正規表現、CUE Langスキーマ、またはその両方を使用します。このポリシーは、構成ファイル、ログストリーム、監査ログを期待されるパターンや構造と照合するのに理想的です。ターゲットが指定されたパターン、スキーマ、または値と一致する場合にコンプライアンスが達成されます。

#### 構成ファイルタイプポリシー（JSON、YAML、TOML、INI）

特定のターゲットタイプを持つ監視対象ファイルの場合、Interceptは非準拠のファイルをコンプライアンスに戻すためのパッチを生成できます。

#### エンドポイントAPIポリシー

APIポリシーは、アシュアランスポリシーの原則をAPIエンドポイントに適用し、定義された標準と期待に合致していることを保証します。

### RUNTIMEポリシー

YAMLベースのserverspecツールキットを利用して、ランタイムポリシーはサーバー構成とリアルタイムのシステム状態を検証します。これらは、サービスと構成状態を監視し、コンプライアンスの変化やドリフトに即座に対応するために不可欠です。

### REGOポリシー

Open Policy Agent（OPA）エンジンを活用して、Regoポリシーは複雑なシナリオでコンプライアンスを評価します。これらは、動的な入力データが正確なコンプライアンスステータスの計算に必要なコンテキスト化されたコンプライアンスチェックで優れています。

## マルチプラットフォーム単一バイナリ

低フットプリントで、どこでも動作します。

## インテグレーションWebhooks

コンプライアンスレポートを即座に適切な受信者に送信します。

## プラットフォーム互換性

| プラットフォーム            | リリース                         | 監査機能セット | ランタイム機能セット |
|-----------------------------|----------------------------------|----------------|----------------------|
| Linux (x86_64)              | intercept-linux-amd64            | フル           | フル                 |
| Linux (ARMv7)               | intercept-linux-arm              | フル           | フル                 |
| Linux (ARM64)               | intercept-linux-arm64            | フル           | フル                 |
| macOS (Intel)               | intercept-darwin-amd64           | フル           | 制限あり             |
| macOS (Apple Silicon)       | intercept-darwin-arm64           | フル           | 制限あり             |
| Windows (x86_64)            | intercept-windows-amd64.exe      | 制限あり       | 制限あり             |